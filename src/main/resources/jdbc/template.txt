SELECT
    t.id,
    t.timestamp,
    metrics.type,
    metrics.value

FROM
(
    SELECT
        id,
        timestamp,
        project_id,
        ROW_NUMBER() OVER (ORDER BY timestamp DESC) - 1 AS rownum

    FROM groups

    WHERE project_id = ? AND timestamp >= ? AND timestamp <= ?

) AS t

INNER JOIN metrics ON t.id = metrics.group_id

WHERE t.rownum % ? = 0;

